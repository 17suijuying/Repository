<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <title>Love . 翁晨博&胡琼雅</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    :root {
      --gap: 24px;
      --text-max: 900px;
      --text-color: #111;
    }

    * { box-sizing: border-box; }
    html { overflow-y: auto; }
    body {
      margin: 0;
      background: #fff;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "PingFang SC","Noto Sans CJK SC","Microsoft YaHei", sans-serif;
      line-height: 1.65;
      color: var(--text-color);
    }

    main.page {
      display: flex;
      flex-direction: column;
      gap: var(--gap);
    }

    figure { margin: 0; }

    .hero, .photo { padding: 0 16px; position: static !important; }

    .hero-img {
      display: block;
      position: static !important;
      width: auto;
      height: auto;
      max-width: 100%;
      max-height: 50vh;
      margin: 0 auto;
      object-fit: contain;
    }

    .kaipian, .yaoqing, .guanyu, .xianglian {
      position: static !important;
      clear: both;
      max-width: var(--text-max);
      margin: 0 auto 48px;
      padding: 0 16px;
      text-align: center;
      line-height: 1.7;
      font-size: 13px;
      color: var(--text-color);
    }
    .kaipian p, .yaoqing p, .guanyu p, .xianglian p { margin: 0.5em 0; }

    /* 普通内容图：与首图等宽（由 JS 设定具体像素宽度） */
    .photo-img {
      display: block;
      width: auto;
      height: auto;
      max-width: 100%;
      margin: 0 auto;
      object-fit: contain;
    }

    /* 新增：左右排版区块（与首图同宽、两列） */
    .split {
      position: static !important;
      clear: both;
      /* 宽度由 JS 设成与首图等宽，这里仅做居中与底部间距 */
      margin: 0 auto 48px;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 24px;
      align-items: center;
    }
    .split-image { display: flex; justify-content: center; }
    .split-text  { text-align: left; padding: 0 16px; }
    .split-text h3 { margin: 0 0 12px; text-align: center; font-weight: 700; }
    .split-text p  { margin: .6em 0; }

    /* 移动端适配：上下排版，图片 100% 宽 */
    @media (max-width: 768px) {
      .hero-img { max-height: 45svh; }
      .kaipian { font-size: clamp(10px, 2.0vw, 12px); }
      .yaoqing { font-size: clamp(10px, 2.0vw, 12px); }
      .guanyu  { font-size: clamp(10px, 2.0vw, 12px); }
      .xianglian{ font-size: clamp(10px, 2.0vw, 12px); }

      .split {
        width: 100% !important;           /* 覆盖 JS 设宽 */
        grid-template-columns: 1fr;       /* 改为单列 */
        padding: 0 16px;                  /* 与其他区块统一边距 */
      }
      .split-text { text-align: center; padding: 0; }
      .split-image .half-img { width: 100% !important; } /* 覆盖内联宽度 */
    }

    #music-toggle {
      position: fixed;
      right: 12px;
      bottom: 12px;
      z-index: 9999;
      padding: 10px 12px;
      border: none;
      border-radius: 999px;
      background: #ffffff;
      box-shadow: 0 4px 16px rgba(0,0,0,.15);
      font-size: 14px;
      cursor: pointer;
    }
    #music-toggle[hidden] { display: none; }
  </style>
</head>
<body>
  <main class="page" id="love-page">
    <figure class="hero">
      <img src="images/shoutu.jpg" alt="首图" class="hero-img" id="heroImg">
    </figure>

    <section class="kaipian">
      <p>FOR YOU/给我最亲爱的你们</p>
      <p>当你们看到这些文字的时候</p>
      <p>已经被我们郑重加入到我们的 INVITATION LIST</p>
      <p>如今我们决定以夫妻之名续写未来的人生</p>
      <p>我们相恋在 2018 年的夏末</p>
      <p>一路走来的酸甜苦辣组成了我们的故事</p>
    </section>

    <figure class="photo">
      <img src="images/zhuanjitu.jpg" alt="转纪图" class="photo-img" loading="lazy" decoding="async">
    </figure>

    <section class="yaoqing">
      <p>“诚挚邀请您来参加婚礼”</p>
      <p>“见证这场因爱而生的结合”</p>
    </section>

    <figure class="photo">
      <img src="images/guanyuwomen.jpg" alt="关于我们" class="photo-img" loading="lazy" decoding="async">
    </figure>
    
    <section class="guanyu">
      <p>故事开始在2015年的夏天</p>
      <p>高二的我们换到了同一个班级</p>
      <p>同学 是我们之间的第一个身份</p>
      <p>印象里 他好像有强迫症 作业工工整整 桌面干干净净</p>
      <p>印象里 她勤奋好学 但眼神中又透露着清澈的“天真”</p>
    </section>

    <figure class="photo">
      <img src="images/haimatichenshan.jpg" alt="海马体衬衫" class="photo-img" loading="lazy" decoding="async">
    </figure>

    <section class="xianglian">
      <p>起初一人在杭州 一人在上海</p>
      <p>从小和山到野马浜</p>
      <p>厚厚的车票连结起两颗炽热的心</p>
      <p>在大大的城市里留下了两人的小小足迹</p>
      <p> </p>
      <p>后来</p>
      <p>一人在杭州念书</p>
      <p>一人回温州工作</p>
      <p>在忙碌的生活中</p>
      <p>每个周末的短暂相逢承载了简单的幸福与对未来的承诺</p>
    </section>

    <figure class="photo">
      <img src="images/xiaoqunzihunshazhao.jpg" alt="小裙子婚纱照" class="photo-img" loading="lazy" decoding="async">
    </figure>

    <!-- 新增：左右排版区块（左图右文） -->
    <section class="split">
      <div class="split-image">
        <!-- 左侧图片：请把 src 换成你的图片路径，如需要可用 /mnt/data/Screenshot_20251123_161247.jpg -->
        <img src="images/dinghunzhao.jpg" alt="订婚照片" class="photo-img half-img" loading="lazy" decoding="async">
      </div>
      <div class="split-text">
        <h3>&lt; 订婚 &gt;</h3>
        <p>2025年2月15日</p>
        <p>我们在双方家人的见证下缔结婚约</p>
        <p>所谓订婚</p>
        <p>是一生相知相守的约定</p>
        <p>愿我们成为彼此余生的依靠</p>
      </div>
    </section>
  </main>

  <audio id="bgm" src="music/达尔文.mp3" preload="auto" loop></audio>
  <button id="music-toggle" hidden aria-label="播放或暂停音乐">▶ 音乐</button>

  <script>
  (function () {
    /* ===== 背景音乐（自动播放 + 交互解锁） ===== */
    const audio = document.getElementById('bgm');
    const btn   = document.getElementById('music-toggle');

    function syncBtn() { btn.textContent = audio.paused ? '▶' : '⏸'; }
    function showBtn() { if (btn.hidden) btn.hidden = false; syncBtn(); }

    async function tryAutoplaySilently() {
      try { audio.muted = true; await audio.play(); showBtn(); }
      catch (e) { showBtn(); }
    }

    let unlocked = false;
    const unlockEventsWin = ['scroll', 'wheel'];
    const unlockEventsDoc = ['pointerdown','touchstart','touchend','click','keydown'];

    async function unlockAndPlay() {
      if (unlocked) return;
      unlocked = true;
      try { audio.muted = false; if (audio.paused) await audio.play(); }
      finally { removeUnlockers(); showBtn(); }
    }

    function addUnlockers() {
      unlockEventsWin.forEach(t => window.addEventListener(t, unlockAndPlay, { passive: true }));
      unlockEventsDoc.forEach(t => document.addEventListener(t, unlockAndPlay, { passive: true }));
    }
    function removeUnlockers() {
      unlockEventsWin.forEach(t => window.removeEventListener(t, unlockAndPlay));
      unlockEventsDoc.forEach(t => document.removeEventListener(t, unlockAndPlay));
    }

    btn.addEventListener('click', async () => {
      try { if (audio.paused) { audio.muted = false; await audio.play(); } else { audio.pause(); } }
      finally { showBtn(); }
    });

    document.addEventListener('DOMContentLoaded', () => {
      tryAutoplaySilently();
      addUnlockers();
    });
    document.addEventListener('visibilitychange', () => {
      if (!document.hidden && audio.paused && !unlocked) { tryAutoplaySilently(); }
    });

    /* ===== 与首图等宽：普通图=1倍，half-img=1/2，左右区块容器也等宽 ===== */
    const heroImg  = document.getElementById('heroImg');
    const selector = '.photo-img';

    function applyWidth(w) {
      // 1) 普通内容图：与首图等宽
      document.querySelectorAll(selector).forEach(img => {
        img.style.width  = w + 'px';
        img.style.height = 'auto';
      });
      // 2) 半宽图片：首图宽度的 1/2
      document.querySelectorAll('.half-img').forEach(img => {
        img.style.width  = Math.max(1, Math.round(w * 0.5)) + 'px';
        img.style.height = 'auto';
      });
      // 3) 左右区块容器：整体与首图等宽并居中
      document.querySelectorAll('.split').forEach(box => {
        box.style.width = w + 'px';
      });
    }

    let rafId = null;
    function scheduleSync() {
      if (rafId) return;
      rafId = requestAnimationFrame(() => {
        rafId = null;
        const rect = heroImg.getBoundingClientRect();
        const w = Math.round(rect.width || 0);
        if (w > 0) applyWidth(w);
      });
    }

    window.addEventListener('load', scheduleSync);
    window.addEventListener('resize', scheduleSync);
    window.addEventListener('orientationchange', scheduleSync);
    window.addEventListener('scroll', scheduleSync, { passive: true });

    if ('ResizeObserver' in window) {
      const ro = new ResizeObserver(scheduleSync);
      ro.observe(heroImg);
    }
    if ('MutationObserver' in window) {
      const mo = new MutationObserver(muts => {
        let need = false;
        for (const m of muts) {
          m.addedNodes && m.addedNodes.forEach(n => {
            if (n.nodeType === 1 && (n.matches?.(selector) || n.querySelector?.(selector) || n.matches?.('.split'))) {
              need = true;
            }
          });
        }
        if (need) scheduleSync();
      });
      mo.observe(document.body, { childList: true, subtree: true });
    }

    if (heroImg.complete) scheduleSync();
    else heroImg.addEventListener('load', scheduleSync, { once: true });

    document.querySelectorAll(selector).forEach(img => {
      if (img.complete) scheduleSync();
      else img.addEventListener('load', scheduleSync, { once: true });
    });
  })();
  </script>
</body>
</html>
