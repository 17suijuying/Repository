<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <title>Love . 翁晨博&胡琼雅</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    /* 颜色与布局参数 */
    :root {
      --gap: 24px;        /* 图片与文字的间距 */
      --text-max: 900px;  /* 文字区域最大宽度（仅用于文字） */
      --text-color: #111; /* 接近黑色的深灰 */
    }

    * { box-sizing: border-box; }
    html { overflow-y: auto; }
    body {
      margin: 0;
      background: #fff;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "PingFang SC","Noto Sans CJK SC","Microsoft YaHei", sans-serif;
      line-height: 1.65;
      color: var(--text-color);
    }

    main.page {
      display: flex;
      flex-direction: column;
      gap: var(--gap);
    }

    figure { margin: 0; }

    /* 首图容器与普通图片容器：仅左右内边距，保持同一基准 */
    .hero,
    .photo {
      padding: 0 16px;
      position: static !important;
    }

    /* 首图：最多半屏高，等比显示、不变形，水平居中 */
    .hero-img {
      display: block;
      position: static !important;
      width: auto;
      height: auto;
      max-width: 100%;
      max-height: 50vh;   /* 桌面端：半屏高上限 */
      margin: 0 auto;
      object-fit: contain;
    }

    /* 文字区（桌面端）：与之前保持一致 */
    .kaipian,
    .yaoqing,
    .guanyu,
    .xianglian,
    .jiehun,
    .qingjian {
      position: static !important;
      clear: both;
      max-width: var(--text-max);
      margin: 0 auto 48px;
      padding: 0 16px;
      text-align: center;
      line-height: 1.7;
      font-size: 13px;          /* 桌面端小字号 */
      color: var(--text-color);
    }
    .kaipian p,
    .yaoqing p,
    .guanyu p,
    .xianglian p,
    .jiehun p,
    .qingjian p{ margin: 0.5em 0; }

    /* 展示图片：默认自适应等比 —— JS 会把它的 width 设为与首图一致 */
    .photo-img {
      display: block;
      width: auto;       /* 将由 JS 设置为与首图等宽 */
      height: auto;      /* 等比例，不变形 */
      max-width: 100%;   /* 小屏下仍不超过视口 */
      margin: 0 auto;
      object-fit: contain;
    }

    /* 左右排版区块（与首图同宽、两列） */
    .split {
      position: static !important;
      clear: both;
      margin: 0 auto 48px;         /* 与其它区块统一的底部间距 */
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 24px;
      align-items: center;
    }
    .split-image { display: flex; justify-content: center; }
    .split-text{
      text-align: center;          /* 与 .xianglian 一致 */
      line-height: 1.7;
      font-size: 13px;
      color: var(--text-color);
      padding: 0 16px;
    }
    .split-text p{ margin: 0.5em 0; }
    .split-text h3{
      margin: 0 0 8px;
      font-weight: 600;
      font-size: 12px;             /* “< 订婚 >”更小 */
      opacity: .9;
    }

    /* 粉色倒计时模块（与首图等宽） */
    .countdown {
      position: static !important;
      clear: both;
      margin: 0 auto 48px;
      padding: 18px 16px 20px;
      text-align: center;
      color: #3b2a2d; /* 在浅粉背景上保持可读 */
      background: linear-gradient(180deg, #FFEAF1 0%, #FFD9E7 100%);
      border-radius: 16px;
      box-shadow: 0 6px 18px rgba(255, 120, 160, .12);
    }
    .countdown h3{
      margin: 0 0 10px;
      font-size: 12px;   /* 克制的小标题 */
      font-weight: 600;
      letter-spacing: .1em;
      color: #5d3b45;
    }
    .cd-grid{
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 12px;
      align-items: end;
      justify-items: center;
      margin: 6px 0 6px;
    }
    .cd-item{
      min-width: 64px;
    }
    .cd-num{
      display: block;
      font-weight: 700;
      font-variant-numeric: tabular-nums;
      line-height: 1.1;
      font-size: 32px;
    }
    .cd-lbl{
      display: block;
      margin-top: 4px;
      font-size: 12px;
      opacity: .85;
    }
    .cd-date{
      margin: 8px 0 0;
      font-size: 12px;
      opacity: .9;
    }

    /* 移动端适配 */
    @media (max-width: 768px) {
      .hero-img { max-height: 45svh; }
      .kaipian { font-size: clamp(10px, 2.0vw, 12px); }
      .yaoqing { font-size: clamp(10px, 2.0vw, 12px); }
      .guanyu  { font-size: clamp(10px, 2.0vw, 12px); }
      .xianglian{ font-size: clamp(10px, 2.0vw, 12px); }

      .split {
        width: 100% !important;           /* 覆盖 JS 设宽 */
        grid-template-columns: 1fr;       /* 改为单列 */
        padding: 0 16px;                  /* 与其他区块统一边距 */
      }
      .split-text{ font-size: clamp(10px, 2.0vw, 12px); }
      .split-text h3{ font-size: clamp(9px, 1.8vw, 11px); }
      .split-image .half-img { width: 100% !important; } /* 覆盖内联宽度 */

      .cd-num{ font-size: clamp(18px, 6vw, 28px); }
      .cd-lbl, .cd-date, .countdown h3{ font-size: clamp(10px, 2vw, 12px); }
    }

    /* 背景音乐按钮 */
    #music-toggle {
      position: fixed;
      right: 12px;
      bottom: 12px;
      z-index: 9999;
      padding: 10px 12px;
      border: none;
      border-radius: 999px;
      background: #ffffff;
      box-shadow: 0 4px 16px rgba(0,0,0,.15);
      font-size: 14px;
      cursor: pointer;
    }
    #music-toggle[hidden] { display: none; }
  </style>
</head>
<body>

  <main class="page" id="love-page">
    <figure class="hero">
      <img src="images/shoutu.jpg" alt="首图" class="hero-img" id="heroImg">
    </figure>

    <section class="kaipian">
      <p>FOR YOU/给我最亲爱的你们</p>
      <p>当你们看到这些文字的时候</p>
      <p>已经被我们郑重加入到我们的 INVITATION LIST</p>
      <p>如今我们决定以夫妻之名续写未来的人生</p>
      <p>我们相恋在 2018 年的夏末</p>
      <p>一路走来的酸甜苦辣组成了我们的故事</p>
    </section>

    <!-- 第一张内容图 -->
    <figure class="photo">
      <img src="images/zhuanjitu.jpg" alt="转纪图" class="photo-img" loading="lazy" decoding="async">
    </figure>

    <section class="yaoqing">
      <p>“诚挚邀请您来参加婚礼”</p>
      <p>“见证这场因爱而生的结合”</p>
    </section>

    <!-- 第二张内容图 -->
    <figure class="photo">
      <img src="images/guanyuwomen.jpg" alt="关于我们" class="photo-img" loading="lazy" decoding="async">
    </figure>
    
    <section class="guanyu">
      <p>故事开始在2015年的夏天</p>
      <p>高二的我们换到了同一个班级</p>
      <p>同学 是我们之间的第一个身份</p>
      <p>印象里 他好像有强迫症 作业工工整整 桌面干干净净</p>
      <p>印象里 她勤奋好学 但眼神中又透露着清澈的“天真”</p>
    </section>

    <figure class="photo">
      <img src="images/haimatichenshan.jpg" alt="海马体衬衫" class="photo-img" loading="lazy" decoding="async">
    </figure>

    <section class="xianglian">
      <p>起初一人在杭州 一人在上海</p>
      <p>从小和山到野马浜</p>
      <p>厚厚的车票连结起两颗炽热的心</p>
      <p>在大大的城市里留下了两人的小小足迹</p>
      <p> </p>
      <p>后来</p>
      <p>一人在杭州念书</p>
      <p>一人回温州工作</p>
      <p>在忙碌的生活中</p>
      <p>每个周末的短暂相逢承载了简单的幸福与对未来的承诺</p>
    </section>

    <figure class="photo">
      <img src="images/xiaoqunzihunshazhao.jpg" alt="小裙子婚纱照" class="photo-img" loading="lazy" decoding="async">
    </figure>

    <!-- 左图右文（图片=首图宽度的1/2；文字样式与 .xianglian 一致） -->
    <section class="split">
      <div class="split-image">
        <!-- 把 src 换成你的实际图片路径 -->
        <img src="images/dinghunzhao.jpg" alt="订婚照片" class="photo-img half-img" loading="lazy" decoding="async">
      </div>
      <div class="split-text">
        <h3>&lt; 订婚 &gt;</h3>
        <p>2025年2月15日</p>
        <p>我们在双方家人的见证下缔结婚约</p>
        <p>所谓订婚</p>
        <p>是一生相知相守的约定</p>
        <p>愿我们成为彼此余生的依靠</p>
      </div>
    </section>

    <figure class="photo">
      <img src="images/hunli.jpg" alt="婚礼" class="photo-img" loading="lazy" decoding="async">
    </figure>

    <section class="jiehun">
      <p>从“学生证”到“结婚证”</p>
      <p>那个炽热的夏天在今岁初冬迎来续集</p>
      <p>终于在2025年12月10日我们决定举办婚礼</p>
      <p>16岁认识你，26岁嫁给你</p>
      <p>很幸运可以与你携手度过一个又一个十年</p>
    </section>

    <figure class="photo">
      <img src="images/haimati.jpg" alt="海马体" class="photo-img" loading="lazy" decoding="async">
    </figure>

    <section class="qingjian">
      <p>在我们无比重要的一天 携同我们的父母</p>
      <p>诚挚的邀请您出席我们的婚礼</p>
      <p>人生一共三万多天 很荣幸这一天</p>
      <p>您能专程为我们而来 与我们共同分享 见证这美好时刻</p>
    </section>

    <figure class="photo">
      <img src="images/zhongshihunshazhao.jpg" alt="中式婚纱照" class="photo-img" loading="lazy" decoding="async">
    </figure>

    <section class="qingjian">
      <p>2025年12月10日 星期三</p>
      <p>农历十月廿一 18:00</p>
    </section>

    <!-- 粉色倒计时模块（与首图等宽） -->
    <section class="countdown" id="countdown" data-deadline="2025-12-10T18:00:00">
      <div class="cd-grid" aria-live="polite">
        <div class="cd-item">
          <span class="cd-num" id="cd-days">00</span>
          <span class="cd-lbl">天</span>
        </div>
        <div class="cd-item">
          <span class="cd-num" id="cd-hours">00</span>
          <span class="cd-lbl">小时</span>
        </div>
        <div class="cd-item">
          <span class="cd-num" id="cd-mins">00</span>
          <span class="cd-lbl">分钟</span>
        </div>
        <div class="cd-item">
          <span class="cd-num" id="cd-secs">00</span>
          <span class="cd-lbl">秒</span>
        </div>
      </div>
    </section>
    
  </main>

  <!-- 背景音乐 -->
  <audio id="bgm" src="music/达尔文.mp3" preload="auto" loop></audio>
  <button id="music-toggle" hidden aria-label="播放或暂停音乐">▶ 音乐</button>

  <script>
  (function () {
    /* ===== 背景音乐（自动播放 + 交互解锁） ===== */
    const audio = document.getElementById('bgm');
    const btn   = document.getElementById('music-toggle');

    function syncBtn() { btn.textContent = audio.paused ? '▶' : '⏸'; }
    function showBtn() { if (btn.hidden) btn.hidden = false; syncBtn(); }

    async function tryAutoplaySilently() {
      try { audio.muted = true; await audio.play(); showBtn(); }
      catch (e) { showBtn(); }
    }

    let unlocked = false;
    const unlockEventsWin = ['scroll', 'wheel'];
    const unlockEventsDoc = ['pointerdown','touchstart','touchend','click','keydown'];

    async function unlockAndPlay() {
      if (unlocked) return;
      unlocked = true;
      try { audio.muted = false; if (audio.paused) await audio.play(); }
      finally { removeUnlockers(); showBtn(); }
    }

    function addUnlockers() {
      unlockEventsWin.forEach(t => window.addEventListener(t, unlockAndPlay, { passive: true }));
      unlockEventsDoc.forEach(t => document.addEventListener(t, unlockAndPlay, { passive: true }));
    }
    function removeUnlockers() {
      unlockEventsWin.forEach(t => window.removeEventListener(t, unlockAndPlay));
      unlockEventsDoc.forEach(t => document.removeEventListener(t, unlockAndPlay));
    }

    btn.addEventListener('click', async () => {
      try { if (audio.paused) { audio.muted = false; await audio.play(); } else { audio.pause(); } }
      finally { showBtn(); }
    });

    document.addEventListener('DOMContentLoaded', () => {
      tryAutoplaySilently();
      addUnlockers();
    });
    document.addEventListener('visibilitychange', () => {
      if (!document.hidden && audio.paused && !unlocked) { tryAutoplaySilently(); }
    });

    /* ===== 与首图等宽：普通图=1倍，half-img=1/2，split 与 countdown 容器也等宽 ===== */
    const heroImg  = document.getElementById('heroImg');
    const selector = '.photo-img';

    function applyWidth(w) {
      // 1) 普通内容图：与首图等宽
      document.querySelectorAll(selector).forEach(img => {
        img.style.width  = w + 'px';
        img.style.height = 'auto';
      });
      // 2) 半宽图片：首图宽度的 1/2
      document.querySelectorAll('.half-img').forEach(img => {
        img.style.width  = Math.max(1, Math.round(w * 0.5)) + 'px';
        img.style.height = 'auto';
      });
      // 3) 容器：split 和 countdown 与首图等宽并居中
      document.querySelectorAll('.split, .countdown').forEach(box => {
        box.style.width = w + 'px';
      });
    }

    let rafId = null;
    function scheduleSync() {
      if (rafId) return;
      rafId = requestAnimationFrame(() => {
        rafId = null;
        const rect = heroImg.getBoundingClientRect();
        const w = Math.round(rect.width || 0);
        if (w > 0) applyWidth(w);
      });
    }

    window.addEventListener('load', scheduleSync);
    window.addEventListener('resize', scheduleSync);
    window.addEventListener('orientationchange', scheduleSync);
    window.addEventListener('scroll', scheduleSync, { passive: true });

    if ('ResizeObserver' in window) {
      const ro = new ResizeObserver(scheduleSync);
      ro.observe(heroImg);
    }
    if ('MutationObserver' in window) {
      const mo = new MutationObserver(muts => {
        let need = false;
        for (const m of muts) {
          m.addedNodes && m.addedNodes.forEach(n => {
            if (n.nodeType === 1 && (n.matches?.(selector) || n.querySelector?.(selector) || n.matches?.('.split') || n.matches?.('.countdown'))) {
              need = true;
            }
          });
        }
        if (need) scheduleSync();
      });
      mo.observe(document.body, { childList: true, subtree: true });
    }

    if (heroImg.complete) scheduleSync();
    else heroImg.addEventListener('load', scheduleSync, { once: true });

    document.querySelectorAll(selector).forEach(img => {
      if (img.complete) scheduleSync();
      else img.addEventListener('load', scheduleSync, { once: true });
    });

    /* ===== 倒计时逻辑 ===== */
    const cd = document.getElementById('countdown');
    if (cd) {
      const ds = cd.dataset.deadline || '2025-12-10T18:00:00';
      const target = new Date(ds);
      const dEl = document.getElementById('cd-days');
      const hEl = document.getElementById('cd-hours');
      const mEl = document.getElementById('cd-mins');
      const sEl = document.getElementById('cd-secs');
      const dateText = document.getElementById('cd-date-text');

      // 将“目标日期”文案显示成人类可读
      try {
        const y = target.getFullYear();
        const mon = target.getMonth() + 1;
        const d = target.getDate();
        if (dateText) dateText.textContent = `${y}年${mon}月${d}日`;
      } catch (e) {}

      function pad(n){ return n < 10 ? '0' + n : '' + n; }

      function tick() {
        const now = new Date();
        let diff = Math.max(0, target - now);

        const days  = Math.floor(diff / (1000*60*60*24));
        diff -= days * (1000*60*60*24);
        const hours = Math.floor(diff / (1000*60*60));
        diff -= hours * (1000*60*60);
        const mins  = Math.floor(diff / (1000*60));
        diff -= mins * (1000*60);
        const secs  = Math.floor(diff / 1000);

        dEl.textContent = pad(days);
        hEl.textContent = pad(hours);
        mEl.textContent = pad(mins);
        sEl.textContent = pad(secs);

        if (target - now <= 0) {
          clearInterval(timer);
        }
      }

      tick();
      const timer = setInterval(tick, 1000);
    }
  })();
  </script>
</body>
</html>
